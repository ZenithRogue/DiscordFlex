(function(e){function t(t){for(var a,i,c=t[0],o=t[1],u=t[2],h=0,d=[];h<c.length;h++)i=c[h],s[i]&&d.push(s[i][0]),s[i]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);l&&l(t);while(d.length)d.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,c=1;c<n.length;c++){var o=n[c];0!==s[o]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},s={app:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=o;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},"2cd4":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a,s=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"navbar"},[n("img",{staticClass:"navLogo",attrs:{src:e.logo}}),n("img",{staticClass:"navUser",attrs:{src:e.avatarURL},on:{click:e.refresh}})]),n("div",{staticClass:"mehBody"},[n("div",{staticClass:"serverList"},[n("img",{staticClass:"server",attrs:{src:e.avatarURL,title:"Direct Messages"},on:{click:e.switchToDMs}}),n("div",{staticClass:"divider"}),e._l(e.guilds,function(e,t){return n("GuildIcon",{key:t,attrs:{guild:e}})})],2),n("div",{staticClass:"channelBar"},[n("div",{staticClass:"title"},[e.activeGuild?n("h3",[e._v(e._s(e.activeGuild))]):e._e()]),n("Channels")],1),n("Chat")],1)])},i=[],c=(n("ac6a"),n("28a5"),n("7f7f"),n("9b19")),o=n.n(c),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat"},[n("div",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll",value:{always:!1,smooth:!0},expression:"{always: false, smooth: true}"}],staticClass:"thread"},[n("infinite-loading",{attrs:{direction:"top"},on:{infinite:e.fetchMessages}}),e._l(e.messages,function(e,t){return n("ChatMessage",{key:t,attrs:{message:e}})})],2),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],staticClass:"compose",style:e.composeHeight,attrs:{type:"text",placeholder:"Enter message..."},domProps:{value:e.content},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.sendMessage(t))},input:function(t){t.target.composing||(e.content=t.target.value)}}})])},l=[],h=n("db0c"),d=n.n(h),f=(n("55dd"),n("96cf"),n("3b8d")),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"message"},[n("img",{staticClass:"profile",attrs:{src:e.avatarURL}}),n("div",{staticClass:"messageStack"},[n("div",{staticClass:"user"},[n("span",{attrs:{title:e.message.author.username+"#"+e.message.author.discriminator}},[e._v(e._s(e.message.member.nickname||e.message.author.username))]),n("div",{staticClass:"info"},[n("Timeago",{attrs:{datetime:e.message.createdAt,"auto-update":60}}),e.message.edited?n("span",{staticStyle:{opacity:"0.5"}},[e._v("(edited)")]):e._e()],1)]),n("div",{staticClass:"messageContent",domProps:{innerHTML:e._s(e.content)}})])])},v=[],g="http://127.0.0.1/";a=localStorage.getItem("token")&&"null"!==localStorage.getItem("token")?localStorage.getItem("token"):function(){return localStorage.setItem("token",prompt("Discord Token")),localStorage.getItem("token")}();var p=a,C=n("a0a0"),b=n("4c16"),y={name:"ChatMessage",props:["message"],computed:{avatarURL:function(){if(this.message.author.avatar)return g+"avatars/".concat(this.message.author.id,"/").concat(this.message.author.avatar);if(!this.message.author.name)return"https://via.placeholder.com/256/2C2F33/FFFFFF?text=ERROR";var e=this.message.author.name.split(/ +/),t="";return e.forEach(function(e){t+=e.charAt(0)}),"https://via.placeholder.com/256/2C2F33/FFFFFF?text="+t},content:function(){return b["a"].parse(Object(C["toHTML"])(this.message.cleanContent))}}},M=y,F=(n("f87e"),n("2877")),k=Object(F["a"])(M,m,v,!1,null,null,null),w=k.exports,_=n("795b"),x=n.n(_),D=n("d225"),O=n("b0b4"),j=n("308d"),R=n("6bb5"),$=n("013f"),T=n("4e2b"),G=n("8055"),E=n.n(G),S=(n("6762"),n("2fdb"),n("5d73")),L=n.n(S),A=n("2f62");s["a"].use(A["a"]);var I=new A["a"].Store({state:{channels:{},guilds:{},messageCache:{},activeGuild:"",activeChannel:"",fetchedChannels:[],userData:!1},mutations:{setUserData:function(e,t){e.userData=t},setGuilds:function(e,t){var n=!0,a=!1,r=void 0;try{for(var i,c=L()(t);!(n=(i=c.next()).done);n=!0){var o=i.value;s["a"].set(e.guilds,o.id,o)}}catch(u){a=!0,r=u}finally{try{n||null==c.return||c.return()}finally{if(a)throw r}}},addGuild:function(e,t){s["a"].set(e.guilds,t.id,t)},setActiveGuild:function(e,t){e.activeGuild=t;var n=e.guilds[t],a={};n.channels.sort(function(e,t){return e.position-t.position}).forEach(function(e){"text"==e.type&&(a[e.id]=e)}),e.channels=a},switchToDMs:function(e,t){e.activeGuild="DM",e.channels=t},setActiveChannel:function(e,t){e.activeChannel=t},addToMessageCache:function(e,t){e.fetchedChannels.includes(t.channel_id)&&(e.messageCache[t.channel_id]||s["a"].set(e.messageCache,t.channel_id,{}),s["a"].set(e.messageCache[t.channel_id],t.id,t))},sortMessageCache:function(e,t){if(e.messageCache[t]){var n=e.messageCache[t],a=d()(n).sort(function(e,t){return e.id-t.id});s["a"].set(e.messageCache,t,{}),a.forEach(function(n){s["a"].set(e.messageCache[t],n.id,n)})}},removeMessageFromCache:function(e,t){e.messageCache[t.channel_id]&&s["a"].delete(e.messageCache[t.channel_id],t.id,t)}},actions:{setActiveChannel:function(){var e=Object(f["a"])(regeneratorRuntime.mark(function e(t,n){var a,s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.state,s=t.commit,!a.fetchedChannels.includes(n)){e.next=3;break}return e.abrupt("return",s("setActiveChannel",n));case 3:return a.fetchedChannels.push(n),s("setActiveChannel",n),e.next=7,B.fetchMessages(n);case 7:r=e.sent,r.forEach(function(e){s("addToMessageCache",e)});case 9:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}(),switchToDMs:function(){var e=Object(f["a"])(regeneratorRuntime.mark(function e(t){var n,a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.state,a=t.commit,"DM"!=n.activeGuild){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,B.fetchDMs();case 5:s=e.sent,a("switchToDMs",s);case 7:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()}}),H=n("faa1"),U=n.n(H),P={guilds:function(e){I.commit("setGuilds",e)},message:function(e){I.commit("addToMessageCache",e)},messageDelete:function(e){I.commit("removeMessageFromCache",e)},messageDeleteBulk:function(e){e.forEach(function(e){I.commit("removeMessageFromCache",e)})},userData:function(e){I.commit("setUserData",e)}},K=function(e){function t(e,n){var a;Object(D["a"])(this,t),a=Object(j["a"])(this,Object(R["a"])(t).call(this));var s=a.socket=E()(n);for(var r in a.loggedIn=!1,P)s.on(r,P[r].bind(Object($["a"])(a)));return s.emit("login",{token:e},function(e){!0===e?a.loggedIn=!0:(localStorage.removeItem("token"),alert("Reload and try again."))}),a}return Object(T["a"])(t,e),Object(O["a"])(t,[{key:"sendMessage",value:function(e,t){this.socket.emit("sendMessage",{channel:e,content:t})}},{key:"fetchMessages",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new x.a(function(a){t.socket.emit("fetchMessages",{id:e,msg:n},a)})}},{key:"fetchDMs",value:function(){var e=this;return new x.a(function(t){e.socket.emit("fetchDMs",t)})}}]),t}(U.a),B=new K(p,g),J=n("e166"),N=n.n(J),q=n("edbf"),z=n.n(q),Q=new z.a;Q.text_mode=!1,Q.replace_mode="unified";var V={name:"Chat",components:{ChatMessage:w,InfiniteLoading:N.a},data:function(){return{content:"",loadingMessages:!1}},methods:{sendMessage:function(){this.content.length&&(B.sendMessage(this.activeChannel,Q.replace_colons(this.content)),this.content="")},fetchMessages:function(){var e=Object(f["a"])(regeneratorRuntime.mark(function e(t){var n,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.activeChannel){e.next=2;break}return e.abrupt("return",setTimeout(function(){return t.loaded()},1e3));case 2:return e.next=4,B.fetchMessages(this.activeChannel,this.earliestMessage);case 4:n=e.sent,n.forEach(function(e){a.$store.commit("addToMessageCache",e)}),this.$store.commit("sortMessageCache",this.activeChannel),t.loaded();case 8:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},computed:{activeChannel:function(){return this.$store.state.activeChannel},messages:function(){return this.$store.state.messageCache[this.$store.state.activeChannel]||{}},composeHeight:function(){var e=30,t=this.content.split("\n").length-1;t>6&&(t=6);var n=e+20*t;return{height:n+"px"}},earliestMessage:function(){if(this.activeChannel){var e=this.messages,t=d()(e).sort(function(e,t){return e.id-t.id});if(t.length)return t[0].id}}}},W=V,X=Object(F["a"])(W,u,l,!1,null,null,null),Y=X.exports,Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"channelList"},e._l(e.channels,function(t){return n("div",{key:t.key,class:"channel"+(e.showHover(t)?" selected":""),on:{mouseover:function(n){return e.onHover(t)},mouseout:e.onStopHover,click:function(n){return e.selectChannel(t)}}},[n("span",[e._v(e._s(e.prefix(t)))]),e._v(e._s(t.name)+"\n    ")])}),0)},ee=[],te={name:"Channels",data:function(){return{hovering:""}},computed:{channels:function(){return this.$store.state.channels},activeChannel:function(){return this.$store.state.activeChannel}},methods:{onHover:function(e){this.hovering=e.id},onStopHover:function(){this.hovering=""},showHover:function(e){return this.activeChannel==e.id||this.hovering==e.id},selectChannel:function(e){this.$store.dispatch("setActiveChannel",e.id)},prefix:function(e){switch(e.type){case"text":return"#";case"dm":return"@";case"group":return"#"}}}},ne=te,ae=Object(F["a"])(ne,Z,ee,!1,null,null,null),se=ae.exports,re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("img",{staticClass:"server",attrs:{src:e.iconURL,title:e.guild.name},on:{click:e.selectGuild}})},ie=[],ce={name:"Guild",props:["guild"],methods:{selectGuild:function(){this.$store.commit("setActiveGuild",this.guild.id)}},computed:{iconURL:function(){if(this.guild.icon)return g+"icons/".concat(this.guild.id,"/").concat(this.guild.icon);if(!this.guild.name)return"https://via.placeholder.com/256/2C2F33/FFFFFF?text=ERROR";var e=this.guild.name.split(/ +/),t="";return e.forEach(function(e){t+=e.charAt(0)}),"https://via.placeholder.com/256/2C2F33/FFFFFF?text="+t}}},oe=ce,ue=(n("735d"),Object(F["a"])(oe,re,ie,!1,null,"181c2e1b",null)),le=ue.exports,he={name:"app",data:function(){return{logo:o.a}},methods:{refresh:function(){var e=confirm("Are you sure you want to reset the token and reload?");e&&(localStorage.removeItem("token"),window.location.reload())},switchToDMs:function(){this.$store.dispatch("switchToDMs")}},computed:{activeGuild:function(){var e=this.$store.state.activeGuild;return!!e.length&&("DM"==e?"Direct Messages":this.$store.state.guilds[e].name)},guilds:function(){return this.$store.state.guilds},userData:function(){return this.$store.state.userData},avatarURL:function(){if(!this.userData)return"https://via.placeholder.com/256/2C2F33/FFFFFF?text=Loading";if(this.userData.avatar)return g+"avatars/".concat(this.userData.id,"/").concat(this.userData.avatar);var e=this.userData.name.split(/ +/),t="";return e.forEach(function(e){t+=e.charAt(0)}),"https://via.placeholder.com/256/2C2F33/FFFFFF?text="+t}},components:{Chat:Y,Channels:se,GuildIcon:le}},de=he,fe=(n("d7f7"),Object(F["a"])(de,r,i,!1,null,"9e3a4304",null)),me=fe.exports,ve=n("8682"),ge=n("123d"),pe=n.n(ge),Ce=n("802e");n("7d05"),n("6de8b");s["a"].config.productionTip=!1,s["a"].use(ve["a"],{name:"Timeago",locale:"en"}),s["a"].use(pe.a),s["a"].use(Ce["default"]),new s["a"]({store:I,render:function(e){return e(me)}}).$mount("#app")},"6de8b":function(e,t,n){},"735d":function(e,t,n){"use strict";var a=n("2cd4"),s=n.n(a);s.a},"7d05":function(e,t,n){},"9b19":function(e,t,n){e.exports=n.p+"img/logo.ae544e54.svg"},"9e3c":function(e,t,n){},c7a0:function(e,t,n){},d7f7:function(e,t,n){"use strict";var a=n("c7a0"),s=n.n(a);s.a},f87e:function(e,t,n){"use strict";var a=n("9e3c"),s=n.n(a);s.a}});
//# sourceMappingURL=app.375d4a17.js.map